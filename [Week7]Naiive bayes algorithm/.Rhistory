cor(df[,c[1:13]])
cor(df[,c(1:13)])
cor(df[,c(1,1:13)])
cor(df[,c(1,2:9)])
cov(df)
cov(as.table(df))
cov(as.table(df))
cor(df)
ggplot(df, aes(age, colour = target)) +
geom_freqpoly(binwidth = 1) + labs(title="Age Distribution by Outcome")
df <- read.csv(file = "C:/Users/user/Desktop/3학년2학기/데이터사이언스/과제/7주/Heart.csv",header=TRUE, fileEncoding = "UCS-2LE")
library(ggplot2)
df <- read.csv(file = "C:/Users/user/Desktop/3학년2학기/데이터사이언스/과제/7주/Heart.csv",header=TRUE, fileEncoding = "UCS-2LE")
df
cov(as.table(df))
cor(df)
df$target <- factor(df$target, levels = c(0,1), labels = c("zero", "one"))
cov(df)
cor(df)
df
cor(df)
library(e1071)
library(caret)
library(ggplot2)
df <- read.csv(file = "C:/Users/user/Desktop/3학년2학기/데이터사이언스/과제/7주/Heart.csv",header=TRUE, fileEncoding = "UCS-2LE")
df
cov(as.table(df))
cor(df)
df
cov(df)
cor(df)
pairs(df,panel = panel.smooth,main="Heart")
pairs(df,panel = panel.smooth,main="Heart")
pairs(train,panel = panel.smooth,main="Heart")
heart.pin <- princomp(df,cor=TRUE)
summary(heart.pin)
screeplot(heart.pin,npcs = 4,type = "lines")
loading(heart.pin)
loadings(heart.pin)
library(e1071)
library(caret)
library(ggplot2)
df <- read.csv(file = "C:/Users/user/Desktop/3학년2학기/데이터사이언스/과제/7주/Heart.csv",header=TRUE, fileEncoding = "UCS-2LE")
df
cov(df)
cor(df)
heart.pin <- princomp(df,cor=TRUE)
summary(heart.pin)
screeplot(heart.pin,npcs = 4,type = "lines")
loadings(heart.pin)
df$target <- factor(df$target, levels = c(0,1), labels = c("zero", "one"))
str(df)
summary(df)
ggplot(df, aes(age, colour = target)) +
geom_freqpoly(binwidth = 1) + labs(title="Age Distribution by Outcome")
set.seed(1234)
intrain<-createDataPartition(y=df$target, p=0.7, list=FALSE)
train<-df[intrain, ]
test<-df[-intrain, ]
print(table(train$target))
print(table(test$target))
model <- naiveBayes(target~.,data = train)
model
summary(model)
pred <- predict(model, test, type='class')
pred
confusionMatrix(pred, test$target)
target <- data.frame(age=24,sex=1, cp=0, trestbps=130,chol=120,fbs=0,restecg=0,thalach=170,exang=1,oldpeak=0.2,slope=1,ca=0,thal=2)
target2 <- data.frame(age=43,sex=1, cp=0, trestbps=120,chol=177,fbs=0,restecg=0,thalach=120,exang=1,oldpeak=2.5,slope=1,ca=0,thal=3)
predict(model, newdata=target)
predict(model, newdata=target2)
model0 <- lm(target~.data=df)
model0 <- lm(target~age+sex+cp+trestbps+chol+fbs+restecg+thalach+exang+oldpeak+slope+ca+thal,data = df)
summary(model0)
model0 <- lm(target~age+sex+cp+trestbps+chol+fbs+restecg+thalach+exang+oldpeak+slope+ca+thal,data = df)
df <- read.csv(file = "C:/Users/user/Desktop/3학년2학기/데이터사이언스/과제/7주/Heart.csv",header=TRUE, fileEncoding = "UCS-2LE")
df
cov(df)
cor(df)
heart.pin <- princomp(df,cor=TRUE)
summary(heart.pin)
screeplot(heart.pin,npcs = 4,type = "lines")
loadings(heart.pin)
model0 <- lm(target~age+sex+cp+trestbps+chol+fbs+restecg+thalach+exang+oldpeak+slope+ca+thal,data = df)
summary(model0)
