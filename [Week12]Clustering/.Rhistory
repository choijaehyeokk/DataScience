x <- cbind(x_felony,x$V4)
x <- as.data.frame(x)
x_felony = as.data.frame(cbind(x$살인,x$강도,x$강간_추행,x$폭력))
x_felony
x_felony = cbind(x$살인,x$강도,x$강간_추행,x$폭력)
x_felony
library(philentropy)
library(NbClust)
library(ggplot2)
library(factoextra)
library(FactoMineR)
중부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 1 , 절도 = 47,폭력 = 19)
종로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 21,폭력 = 16)
남대문 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 14,폭력 = 3)
서대문 <- c(살인  = 0, 강도 = 3, 강간_추행 = 9 , 절도 = 89,폭력 = 85)
혜화 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 19,폭력 = 17)
용산 <- c(살인  = 0, 강도 = 4, 강간_추행 = 3 , 절도 = 21,폭력 = 35)
성북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 54,폭력 = 71)
동대문 <- c(살인  = 0, 강도 = 2, 강간_추행 = 4 , 절도 = 112,폭력 = 126)
마포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 18 , 절도 = 127,폭력 = 98)
영등포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 6 , 절도 = 144,폭력 = 150)
성동 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 42,폭력 = 52)
동작 <- c(살인  = 0, 강도 = 0, 강간_추행 = 10 , 절도 = 72,폭력 = 113)
광진 <- c(살인  = 0, 강도 = 0, 강간_추행 = 12 , 절도 = 115,폭력 = 191)
서부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 93,폭력 = 43)
강북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 8 , 절도 = 82,폭력 = 147)
금천 <- c(살인  = 0, 강도 = 0, 강간_추행 = 5 , 절도 = 65,폭력 = 76)
중랑 <- c(살인  = 0, 강도 = 5, 강간_추행 = 4 , 절도 = 137,폭력 = 155)
강남 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 66,폭력 = 44)
관악 <- c(살인  = 0, 강도 = 14, 강간_추행 = 15 , 절도 = 102,폭력 = 190)
강서 <- c(살인  = 2, 강도 = 2, 강간_추행 = 11 , 절도 = 228,폭력 = 167)
강동 <- c(살인  = 0, 강도 = 20, 강간_추행 = 10 , 절도 = 177,폭력 = 155)
종암 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 61,폭력 = 80)
구로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 15 , 절도 = 185,폭력 = 148)
서초 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 63,폭력 = 80)
양천 <- c(살인  = 0, 강도 = 1, 강간_추행 = 9 , 절도 = 162,폭력 = 128)
송파 <- c(살인  = 0, 강도 = 11, 강간_추행 = 27 , 절도 = 166,폭력 = 153)
노원 <- c(살인  = 0, 강도 = 1, 강간_추행 = 22 , 절도 = 112,폭력 = 195)
방배 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 19,폭력 = 22)
은평 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 134,폭력 = 110)
도봉 <- c(살인  = 0, 강도 = 6, 강간_추행 = 11 , 절도 = 59,폭력 = 89)
수서 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 73,폭력 = 82)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
getDistMethods()
x_dist <- dist(x, method = "euclidean")
x_dist
m_dist <- dist(x, method = "manhattan")
m_dist
hc <- hclust(dist(x, method = "euclidean", diag = TRUE),
method = "single")
hc
plot(hc, hang= -1, cex=0.8)
rect.hclust(hc, k = 6, border = 1:6)
abline(h = 33, col="red")
은평 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 134,폭력 = 110)
도봉 <- c(살인  = 0, 강도 = 6, 강간_추행 = 11 , 절도 = 59,폭력 = 89)
수서 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 73,폭력 = 82)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
getDistMethods()
x_dist <- dist(x, method = "euclidean")
x_dist
m_dist <- dist(x, method = "manhattan")
m_dist
hc <- hclust(dist(x, method = "euclidean", diag = TRUE),
method = "single")
hc
plot(hc, hang= -1, cex=0.8)
View(hc)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
library(philentropy)
library(NbClust)
library(ggplot2)
library(factoextra)
library(FactoMineR)
중부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 1 , 절도 = 47,폭력 = 19)
종로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 21,폭력 = 16)
남대문 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 14,폭력 = 3)
서대문 <- c(살인  = 0, 강도 = 3, 강간_추행 = 9 , 절도 = 89,폭력 = 85)
혜화 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 19,폭력 = 17)
용산 <- c(살인  = 0, 강도 = 4, 강간_추행 = 3 , 절도 = 21,폭력 = 35)
성북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 54,폭력 = 71)
동대문 <- c(살인  = 0, 강도 = 2, 강간_추행 = 4 , 절도 = 112,폭력 = 126)
마포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 18 , 절도 = 127,폭력 = 98)
영등포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 6 , 절도 = 144,폭력 = 150)
성동 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 42,폭력 = 52)
동작 <- c(살인  = 0, 강도 = 0, 강간_추행 = 10 , 절도 = 72,폭력 = 113)
광진 <- c(살인  = 0, 강도 = 0, 강간_추행 = 12 , 절도 = 115,폭력 = 191)
서부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 93,폭력 = 43)
강북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 8 , 절도 = 82,폭력 = 147)
금천 <- c(살인  = 0, 강도 = 0, 강간_추행 = 5 , 절도 = 65,폭력 = 76)
중랑 <- c(살인  = 0, 강도 = 5, 강간_추행 = 4 , 절도 = 137,폭력 = 155)
강남 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 66,폭력 = 44)
관악 <- c(살인  = 0, 강도 = 14, 강간_추행 = 15 , 절도 = 102,폭력 = 190)
강서 <- c(살인  = 2, 강도 = 2, 강간_추행 = 11 , 절도 = 228,폭력 = 167)
강동 <- c(살인  = 0, 강도 = 20, 강간_추행 = 10 , 절도 = 177,폭력 = 155)
종암 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 61,폭력 = 80)
구로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 15 , 절도 = 185,폭력 = 148)
서초 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 63,폭력 = 80)
양천 <- c(살인  = 0, 강도 = 1, 강간_추행 = 9 , 절도 = 162,폭력 = 128)
송파 <- c(살인  = 0, 강도 = 11, 강간_추행 = 27 , 절도 = 166,폭력 = 153)
노원 <- c(살인  = 0, 강도 = 1, 강간_추행 = 22 , 절도 = 112,폭력 = 195)
방배 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 19,폭력 = 22)
은평 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 134,폭력 = 110)
도봉 <- c(살인  = 0, 강도 = 6, 강간_추행 = 11 , 절도 = 59,폭력 = 89)
수서 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 73,폭력 = 82)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
getDistMethods()
x_dist <- dist(x, method = "euclidean")
x_dist
m_dist <- dist(x, method = "manhattan")
m_dist
hc <- hclust(dist(x, method = "euclidean", diag = TRUE),
method = "single")
hc
plot(hc, hang= -1, cex=0.8)
View(x)
class(x)
x_felony = x[1:3,:5]
x_felony = x[1:3,4:5]
x_felony
x_felony = x[1:10,4:5]
x_felony
x_felony = x[1:31,4:5]
x_felony
x_felony = x[1:31,1:2,4:5]
x_felony = x[1:31,c(1,2,4,5)]
x_felony
x_felony = apply(x_felony,2,sum)
x_felony
x_felony = apply(x_felony,1,sum)
x_felony
x_felony = x[1:31,c(1,2,4,5)]
x_felony
x_felony = apply(x_felony,1,sum)
x_felony
rbind(x_felony,x[3:3])
x <- rbind(x_felony,x[3:3])
xstr(x)
x
View(x)
x <- rbind(x_felony,x[2:3])
x <- rbind(x_felony,x[,3])
x <- rbind(x_felony,x[1:31,c(3)])
x <- rbind(x_felony,x[1:30,c(3)])
x[,3]
library(philentropy)
library(NbClust)
library(ggplot2)
library(factoextra)
library(FactoMineR)
중부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 1 , 절도 = 47,폭력 = 19)
종로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 21,폭력 = 16)
남대문 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 14,폭력 = 3)
서대문 <- c(살인  = 0, 강도 = 3, 강간_추행 = 9 , 절도 = 89,폭력 = 85)
혜화 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 19,폭력 = 17)
용산 <- c(살인  = 0, 강도 = 4, 강간_추행 = 3 , 절도 = 21,폭력 = 35)
성북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 54,폭력 = 71)
동대문 <- c(살인  = 0, 강도 = 2, 강간_추행 = 4 , 절도 = 112,폭력 = 126)
마포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 18 , 절도 = 127,폭력 = 98)
영등포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 6 , 절도 = 144,폭력 = 150)
성동 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 42,폭력 = 52)
동작 <- c(살인  = 0, 강도 = 0, 강간_추행 = 10 , 절도 = 72,폭력 = 113)
광진 <- c(살인  = 0, 강도 = 0, 강간_추행 = 12 , 절도 = 115,폭력 = 191)
서부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 93,폭력 = 43)
강북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 8 , 절도 = 82,폭력 = 147)
금천 <- c(살인  = 0, 강도 = 0, 강간_추행 = 5 , 절도 = 65,폭력 = 76)
중랑 <- c(살인  = 0, 강도 = 5, 강간_추행 = 4 , 절도 = 137,폭력 = 155)
강남 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 66,폭력 = 44)
관악 <- c(살인  = 0, 강도 = 14, 강간_추행 = 15 , 절도 = 102,폭력 = 190)
강서 <- c(살인  = 2, 강도 = 2, 강간_추행 = 11 , 절도 = 228,폭력 = 167)
강동 <- c(살인  = 0, 강도 = 20, 강간_추행 = 10 , 절도 = 177,폭력 = 155)
종암 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 61,폭력 = 80)
구로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 15 , 절도 = 185,폭력 = 148)
서초 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 63,폭력 = 80)
양천 <- c(살인  = 0, 강도 = 1, 강간_추행 = 9 , 절도 = 162,폭력 = 128)
송파 <- c(살인  = 0, 강도 = 11, 강간_추행 = 27 , 절도 = 166,폭력 = 153)
노원 <- c(살인  = 0, 강도 = 1, 강간_추행 = 22 , 절도 = 112,폭력 = 195)
방배 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 19,폭력 = 22)
은평 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 134,폭력 = 110)
도봉 <- c(살인  = 0, 강도 = 6, 강간_추행 = 11 , 절도 = 59,폭력 = 89)
수서 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 73,폭력 = 82)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
class(x)
getDistMethods()
x_dist <- dist(x, method = "euclidean")
x_dist
m_dist <- dist(x, method = "manhattan")
m_dist
#=======================================
#전체적인 범죄 성향이 비슷한 집단으로 군집화 진행행
hc <- hclust(dist(x, method = "euclidean", diag = TRUE),
method = "single")
hc
plot(hc, hang= -1, cex=0.8)
rect.hclust(hc, k = 6, border = 1:6)
abline(h = 33, col="red")
x_felony = x[1:31,c(1,2,4,5)]
x_felony
x_felony = apply(x_felony,1,sum)
x_felony
x[,3]
x <- rbind(x_felony,x[1:31,x[,3]])
y<-x[,3]
x <- rbind(x_felony,x[1:31,y])
x <- rbind(x_felony,y)
x
x <- cbind(x_felony,y)
x
y<-x[,4]
x_felony = x[1:31,c(1,2,3,5)]
x_felony
x_felony = apply(x_felony,1,sum)
x_felony
y<-x[,4]
library(philentropy)
library(NbClust)
library(ggplot2)
library(factoextra)
library(FactoMineR)
중부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 1 , 절도 = 47,폭력 = 19)
종로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 21,폭력 = 16)
남대문 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 14,폭력 = 3)
서대문 <- c(살인  = 0, 강도 = 3, 강간_추행 = 9 , 절도 = 89,폭력 = 85)
혜화 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 19,폭력 = 17)
용산 <- c(살인  = 0, 강도 = 4, 강간_추행 = 3 , 절도 = 21,폭력 = 35)
성북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 54,폭력 = 71)
동대문 <- c(살인  = 0, 강도 = 2, 강간_추행 = 4 , 절도 = 112,폭력 = 126)
마포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 18 , 절도 = 127,폭력 = 98)
영등포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 6 , 절도 = 144,폭력 = 150)
성동 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 42,폭력 = 52)
동작 <- c(살인  = 0, 강도 = 0, 강간_추행 = 10 , 절도 = 72,폭력 = 113)
광진 <- c(살인  = 0, 강도 = 0, 강간_추행 = 12 , 절도 = 115,폭력 = 191)
서부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 93,폭력 = 43)
강북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 8 , 절도 = 82,폭력 = 147)
금천 <- c(살인  = 0, 강도 = 0, 강간_추행 = 5 , 절도 = 65,폭력 = 76)
중랑 <- c(살인  = 0, 강도 = 5, 강간_추행 = 4 , 절도 = 137,폭력 = 155)
강남 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 66,폭력 = 44)
관악 <- c(살인  = 0, 강도 = 14, 강간_추행 = 15 , 절도 = 102,폭력 = 190)
강서 <- c(살인  = 2, 강도 = 2, 강간_추행 = 11 , 절도 = 228,폭력 = 167)
강동 <- c(살인  = 0, 강도 = 20, 강간_추행 = 10 , 절도 = 177,폭력 = 155)
종암 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 61,폭력 = 80)
구로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 15 , 절도 = 185,폭력 = 148)
서초 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 63,폭력 = 80)
양천 <- c(살인  = 0, 강도 = 1, 강간_추행 = 9 , 절도 = 162,폭력 = 128)
송파 <- c(살인  = 0, 강도 = 11, 강간_추행 = 27 , 절도 = 166,폭력 = 153)
노원 <- c(살인  = 0, 강도 = 1, 강간_추행 = 22 , 절도 = 112,폭력 = 195)
방배 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 19,폭력 = 22)
은평 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 134,폭력 = 110)
도봉 <- c(살인  = 0, 강도 = 6, 강간_추행 = 11 , 절도 = 59,폭력 = 89)
수서 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 73,폭력 = 82)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
class(x)
getDistMethods()
x_dist <- dist(x, method = "euclidean")
x_dist
m_dist <- dist(x, method = "manhattan")
m_dist
#=======================================
#전체적인 범죄 성향이 비슷한 집단으로 군집화 진행행
hc <- hclust(dist(x, method = "euclidean", diag = TRUE),
method = "single")
hc
plot(hc, hang= -1, cex=0.8)
rect.hclust(hc, k = 6, border = 1:6)
abline(h = 33, col="red")
x_felony = x[1:31,c(1,2,3,5)]
x_felony
x_felony = apply(x_felony,1,sum)
x_felony
y<-x[,4]
x <- cbind(x_felony,y)
x
colnames(x) <- c("중범죄","경범죄")
str(x)
x
str(x)
df <- scale(x)
df
head(df, n = 3)
set.seed(1)
km.res <- kmeans(df, 3, nstart = 25)
print(km.res)
new_x <- data.frame(x)
x <- cbind(new_x$강간_추행,new_x$절도,new_x$폭력)
library(philentropy)
library(NbClust)
library(ggplot2)
library(factoextra)
library(FactoMineR)
중부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 1 , 절도 = 47,폭력 = 19)
종로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 21,폭력 = 16)
남대문 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 14,폭력 = 3)
서대문 <- c(살인  = 0, 강도 = 3, 강간_추행 = 9 , 절도 = 89,폭력 = 85)
혜화 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 19,폭력 = 17)
용산 <- c(살인  = 0, 강도 = 4, 강간_추행 = 3 , 절도 = 21,폭력 = 35)
성북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 54,폭력 = 71)
동대문 <- c(살인  = 0, 강도 = 2, 강간_추행 = 4 , 절도 = 112,폭력 = 126)
마포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 18 , 절도 = 127,폭력 = 98)
영등포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 6 , 절도 = 144,폭력 = 150)
성동 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 42,폭력 = 52)
동작 <- c(살인  = 0, 강도 = 0, 강간_추행 = 10 , 절도 = 72,폭력 = 113)
광진 <- c(살인  = 0, 강도 = 0, 강간_추행 = 12 , 절도 = 115,폭력 = 191)
서부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 93,폭력 = 43)
강북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 8 , 절도 = 82,폭력 = 147)
금천 <- c(살인  = 0, 강도 = 0, 강간_추행 = 5 , 절도 = 65,폭력 = 76)
중랑 <- c(살인  = 0, 강도 = 5, 강간_추행 = 4 , 절도 = 137,폭력 = 155)
강남 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 66,폭력 = 44)
관악 <- c(살인  = 0, 강도 = 14, 강간_추행 = 15 , 절도 = 102,폭력 = 190)
강서 <- c(살인  = 2, 강도 = 2, 강간_추행 = 11 , 절도 = 228,폭력 = 167)
강동 <- c(살인  = 0, 강도 = 20, 강간_추행 = 10 , 절도 = 177,폭력 = 155)
종암 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 61,폭력 = 80)
구로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 15 , 절도 = 185,폭력 = 148)
서초 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 63,폭력 = 80)
양천 <- c(살인  = 0, 강도 = 1, 강간_추행 = 9 , 절도 = 162,폭력 = 128)
송파 <- c(살인  = 0, 강도 = 11, 강간_추행 = 27 , 절도 = 166,폭력 = 153)
노원 <- c(살인  = 0, 강도 = 1, 강간_추행 = 22 , 절도 = 112,폭력 = 195)
방배 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 19,폭력 = 22)
은평 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 134,폭력 = 110)
도봉 <- c(살인  = 0, 강도 = 6, 강간_추행 = 11 , 절도 = 59,폭력 = 89)
수서 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 73,폭력 = 82)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
class(x)
getDistMethods()
x_dist <- dist(x, method = "euclidean")
x_dist
m_dist <- dist(x, method = "manhattan")
m_dist
#=======================================
#전체적인 범죄 성향이 비슷한 집단으로 군집화 진행행
hc <- hclust(dist(x, method = "euclidean", diag = TRUE),
method = "single")
hc
plot(hc, hang= -1, cex=0.8)
plot(hc)
#=======================================
#전체적인 범죄 성향이 비슷한 집단으로 군집화 진행행
hc <- hclust(dist(x, method = "euclidean", diag = TRUE), method = "average")
hc
plot(hc)
#=======================================
#전체적인 범죄 성향이 비슷한 집단으로 군집화 진행행
hc <- hclust(dist(x, method = "euclidean", diag = TRUE), method = "single")
#=======================================
#전체적인 범죄 성향이 비슷한 집단으로 군집화 진행행
hc <- hclust(dist(x, method = "euclidean", diag = TRUE), method = "single")
hc
plot(hc)
rect.hclust(hc, k = 6, border = 1:6)
abline(h = 33, col="red")
x_felony = x[1:31,c(1,2,3,5)]
x_felony
x_felony = apply(x_felony,1,sum)
x_felony
y<-x[,4]
x <- cbind(x_felony,y)
colnames(x) <- c("중범죄","경범죄")
x
str(x)
df <- scale(x)
df
head(df, n = 3)
set.seed(1)
km.res <- kmeans(df, 3, nstart = 25)
print(km.res)
new_x <- data.frame(x)
n <- NbClust(x, min.nc=2, max.nc=15, method="kmeans")
par(mfrow=c(1,1))
barplot(table(n$Best.nc[1,]),
xlab="Numer of Clusters", ylab="Number of Criteria",
main="Number of Clusters Chosen")
wssplot <- function(data, nc=15, seed=1234){
wss <- (nrow(data)-1)*sum(apply(data,2,var)) # K = 1, Total SS
for (i in 2:nc){
set.seed(seed)
wss[i] <- sum(kmeans(data, centers=i)$withinss)}
plot(1:nc, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
}
wssplot(x)
km.res <- kmeans(x,2,nstart = 10)
km.res
df_member <- cbind(x,cluster=km.res$cluster)
head(df_member)
fviz_cluster(km.res,data=x,palette=c("red","blue"),ellipse.type="euclid",star.plot=T,repel=T,ggtheme=theme())
km.res <- kmeans(x,10,nstart = 10)
km.res
df_member <- cbind(x,cluster=km.res$cluster)
head(df_member)
fviz_cluster(km.res,data=x,palette=c("red","blue"),ellipse.type="euclid",star.plot=T,repel=T,ggtheme=theme())
km.res <- kmeans(x,3,nstart = 10)
km.res
df_member <- cbind(x,cluster=km.res$cluster)
head(df_member)
fviz_cluster(km.res,data=x,palette=c("red","blue"),ellipse.type="euclid",star.plot=T,repel=T,ggtheme=theme())
wssplot(x)
km.res <- kmeans(x,3,nstart = 10)
km.res
df_member <- cbind(x,cluster=km.res$cluster)
head(df_member)
fviz_cluster(km.res,data=x,palette=c("red","blue","green"),ellipse.type="euclid",star.plot=T,repel=T,ggtheme=theme())
km.res <- kmeans(x,2,nstart = 10)
km.res
df_member <- cbind(x,cluster=km.res$cluster)
head(df_member)
fviz_cluster(km.res,data=x,palette=c("red","blue","green"),ellipse.type="euclid",star.plot=T,repel=T,ggtheme=theme())
library(philentropy)
library(NbClust)
library(ggplot2)
library(factoextra)
library(FactoMineR)
중부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 1 , 절도 = 47,폭력 = 19)
종로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 21,폭력 = 16)
남대문 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 14,폭력 = 3)
서대문 <- c(살인  = 0, 강도 = 3, 강간_추행 = 9 , 절도 = 89,폭력 = 85)
혜화 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 19,폭력 = 17)
용산 <- c(살인  = 0, 강도 = 4, 강간_추행 = 3 , 절도 = 21,폭력 = 35)
성북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 54,폭력 = 71)
동대문 <- c(살인  = 0, 강도 = 2, 강간_추행 = 4 , 절도 = 112,폭력 = 126)
마포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 18 , 절도 = 127,폭력 = 98)
영등포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 6 , 절도 = 144,폭력 = 150)
성동 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 42,폭력 = 52)
동작 <- c(살인  = 0, 강도 = 0, 강간_추행 = 10 , 절도 = 72,폭력 = 113)
광진 <- c(살인  = 0, 강도 = 0, 강간_추행 = 12 , 절도 = 115,폭력 = 191)
서부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 93,폭력 = 43)
강북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 8 , 절도 = 82,폭력 = 147)
금천 <- c(살인  = 0, 강도 = 0, 강간_추행 = 5 , 절도 = 65,폭력 = 76)
중랑 <- c(살인  = 0, 강도 = 5, 강간_추행 = 4 , 절도 = 137,폭력 = 155)
강남 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 66,폭력 = 44)
관악 <- c(살인  = 0, 강도 = 14, 강간_추행 = 15 , 절도 = 102,폭력 = 190)
강서 <- c(살인  = 2, 강도 = 2, 강간_추행 = 11 , 절도 = 228,폭력 = 167)
강동 <- c(살인  = 0, 강도 = 20, 강간_추행 = 10 , 절도 = 177,폭력 = 155)
종암 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 61,폭력 = 80)
구로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 15 , 절도 = 185,폭력 = 148)
서초 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 63,폭력 = 80)
양천 <- c(살인  = 0, 강도 = 1, 강간_추행 = 9 , 절도 = 162,폭력 = 128)
송파 <- c(살인  = 0, 강도 = 11, 강간_추행 = 27 , 절도 = 166,폭력 = 153)
노원 <- c(살인  = 0, 강도 = 1, 강간_추행 = 22 , 절도 = 112,폭력 = 195)
방배 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 19,폭력 = 22)
은평 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 134,폭력 = 110)
도봉 <- c(살인  = 0, 강도 = 6, 강간_추행 = 11 , 절도 = 59,폭력 = 89)
수서 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 73,폭력 = 82)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
class(x)
getDistMethods()
x_dist <- dist(x, method = "euclidean")
x_dist
m_dist <- dist(x, method = "manhattan")
m_dist
#=======================================
#전체적인 범죄 성향이 비슷한 집단으로 군집화 진행행
hc <- hclust(dist(x, method = "euclidean", diag = TRUE), method = "single")
hc
plot(hc)
library(philentropy)
library(NbClust)
library(ggplot2)
library(factoextra)
library(FactoMineR)
중부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 1 , 절도 = 47,폭력 = 19)
종로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 21,폭력 = 16)
남대문 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 14,폭력 = 3)
서대문 <- c(살인  = 0, 강도 = 3, 강간_추행 = 9 , 절도 = 89,폭력 = 85)
혜화 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 19,폭력 = 17)
용산 <- c(살인  = 0, 강도 = 4, 강간_추행 = 3 , 절도 = 21,폭력 = 35)
성북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 54,폭력 = 71)
동대문 <- c(살인  = 0, 강도 = 2, 강간_추행 = 4 , 절도 = 112,폭력 = 126)
마포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 18 , 절도 = 127,폭력 = 98)
영등포 <- c(살인  = 0, 강도 = 0, 강간_추행 = 6 , 절도 = 144,폭력 = 150)
성동 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 42,폭력 = 52)
동작 <- c(살인  = 0, 강도 = 0, 강간_추행 = 10 , 절도 = 72,폭력 = 113)
광진 <- c(살인  = 0, 강도 = 0, 강간_추행 = 12 , 절도 = 115,폭력 = 191)
서부 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 93,폭력 = 43)
강북 <- c(살인  = 0, 강도 = 0, 강간_추행 = 8 , 절도 = 82,폭력 = 147)
금천 <- c(살인  = 0, 강도 = 0, 강간_추행 = 5 , 절도 = 65,폭력 = 76)
중랑 <- c(살인  = 0, 강도 = 5, 강간_추행 = 4 , 절도 = 137,폭력 = 155)
강남 <- c(살인  = 0, 강도 = 0, 강간_추행 = 9 , 절도 = 66,폭력 = 44)
관악 <- c(살인  = 0, 강도 = 14, 강간_추행 = 15 , 절도 = 102,폭력 = 190)
강서 <- c(살인  = 2, 강도 = 2, 강간_추행 = 11 , 절도 = 228,폭력 = 167)
강동 <- c(살인  = 0, 강도 = 20, 강간_추행 = 10 , 절도 = 177,폭력 = 155)
종암 <- c(살인  = 0, 강도 = 0, 강간_추행 = 3 , 절도 = 61,폭력 = 80)
구로 <- c(살인  = 0, 강도 = 0, 강간_추행 = 15 , 절도 = 185,폭력 = 148)
서초 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 63,폭력 = 80)
양천 <- c(살인  = 0, 강도 = 1, 강간_추행 = 9 , 절도 = 162,폭력 = 128)
송파 <- c(살인  = 0, 강도 = 11, 강간_추행 = 27 , 절도 = 166,폭력 = 153)
노원 <- c(살인  = 0, 강도 = 1, 강간_추행 = 22 , 절도 = 112,폭력 = 195)
방배 <- c(살인  = 0, 강도 = 0, 강간_추행 = 0 , 절도 = 19,폭력 = 22)
은평 <- c(살인  = 0, 강도 = 0, 강간_추행 = 16 , 절도 = 134,폭력 = 110)
도봉 <- c(살인  = 0, 강도 = 6, 강간_추행 = 11 , 절도 = 59,폭력 = 89)
수서 <- c(살인  = 0, 강도 = 0, 강간_추행 = 2 , 절도 = 73,폭력 = 82)
x <- rbind(중부,종로,남대문,서대문,혜화,용산,성북,동대문,마포,영등포,성동,동작,광진,서부,강북,금천,중랑,강남,관악,강서,강동,종암,구로,서초,양천,송파,노원,방배,은평,도봉,수서)
x
getDistMethods()
x_dist <- dist(x, method = "euclidean")
x_dist
m_dist <- dist(x, method = "manhattan")
m_dist
#=======================================
#전체적인 범죄 성향이 비슷한 집단으로 군집화 진행행
hc <- hclust(dist(x, method = "euclidean", diag = TRUE),
method = "single")
hc
plot(hc, hang= -1, cex=0.8)
rect.hclust(hc, k = 6, border = 1:6)
abline(h = 33, col="red")
